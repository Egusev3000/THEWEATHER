{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–≥–æ–¥–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–∞—à–∏ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="index-body">
    {% include "main/menu.html" %}

    <div class="main-search-section">
        <div class="container">
            <div class="search-header text-center">
                <h1>–ü–æ–≥–æ–¥–∞ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</h1>
                <p>–í—ã —É–∑–Ω–∞–ª–∏ –ø–æ–≥–æ–¥—É –ø–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤–∞–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º</p>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <!-- –¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞ -->
        <section class="weather-section mb-5" id="weatherSection">
            <h2 class="section-title">–¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞</h2>
            <div class="row g-4" id="weatherCard">
                <div class="col-md-6 col-sm-12">
                    <div class="weather-card">
                        <h3>{{ weather.city }}</h3>
                        <p>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ weather.temperature }}¬∞C</p>
                        <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: {{ weather.condition }}</p>
                        <p>–í–ª–∞–∂–Ω–æ—Å—Ç—å: {{ weather.humidity }}%</p>
                        <p>–í–µ—Ç–µ—Ä: {{ weather.wind_speed }} –∫–º/—á</p>
                        <p>
                            <span class="info-tooltip">?</span>
                            <strong>–ò–Ω–¥–µ–∫—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞: {{ weather.comfort_index }}/100</strong>
                        </p>
                        <div class="feedback-buttons">
                            <button class="btn-feedback" onclick="sendFeedback('${data.weather_data.city}', true)">üëç</button>
                            <button class="btn-feedback" onclick="sendFeedback('${data.weather_data.city}', false)">üëé</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 3 –¥–Ω—è -->
        <section class="forecast-section mb-5">
            <h2 class="section-title">–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ 3 –¥–Ω—è</h2>
            <div class="row g-4" id="forecastCard">
                {% for day in forecast_data %}
                    <div class="col-md-4 col-sm-12">
                        <div class="weather-card">
                            <h4>{{ day.date }}</h4>
                            <p>–ú–∞–∫—Å. —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ day.temperature_max }}¬∞C</p>
                            <p>–ú–∏–Ω. —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ day.temperature_min }}¬∞C</p>
                            <p>–°–æ—Å—Ç–æ—è–Ω–∏–µ: {{ day.condition }}</p>
                            <p>
                                <span class="info-tooltip">?</span>
                                <strong>–ò–Ω–¥–µ–∫—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞: {{ day.comfort_index }}/100</strong>
                            </p>
                        </div>
                    </div>
                {% endfor %}
                {% if forecast_data|length == 0 %}
                    <div class="col-md-12">
                        <h3 class="no-forecast">–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 3 –¥–Ω—è –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω.</h3>
                    </div>
                {% endif %}
            </div>
        </section>
    </div>
    <link rel="stylesheet" href="{% static 'css/main/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/weather/weather_card.css' %}">

    {% include "main/footer.html" %}

    <script>
        function sendFeedback(city, isCorrect) {
            console.log(`–û—Ç–∑—ã–≤ –æ –ø–æ–≥–æ–¥–µ –≤ –≥–æ—Ä–æ–¥–µ ${city}: ${isCorrect ? '–°–æ–≤–ø–∞–¥–∞–µ—Ç' : '–ù–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç'}`);
            alert(`–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –æ—Ç–∑—ã–≤ –æ –ø–æ–≥–æ–¥–µ –≤ –≥–æ—Ä–æ–¥–µ ${city}: ${isCorrect ? '–°–æ–≤–ø–∞–¥–∞–µ—Ç' : '–ù–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç'}`);
        }
    </script>
</body>
</html>

<style>
    .info-tooltip {
        display: inline-block;
        width: 18px;
        height: 18px;
        line-height: 18px;
        text-align: center;
        border-radius: 50%;
        background-color: #3498db;
        color: white;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        margin-right: 5px;
        position: relative;
    }

    .info-tooltip::after {
        content: "–ò–Ω–¥–µ–∫—Å –∫–æ–º—Ñ–æ—Ä—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É –ø–æ–≥–æ–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã, –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –∏ –≤–µ—Ç—Ä–∞.";
        position: absolute;
        left: 50%;
        bottom: 150%;
        transform: translateX(-50%);
        background-color: white;
        color: black;
        padding: 5px 10px;
        border-radius: 5px;
        border: 1px solid black;
        white-space: normal;
        font-size: 12px;
        box-shadow: 0px 0px 5px rgba(0,0,0,0.3);
        width: 200px;
        text-align: center;
        display: none;
    }

    .info-tooltip:hover::after {
        display: block;
    }

    .feedback-buttons {
        margin-top: 10px;
        display: flex;
        justify-content: center;
        gap: 10px;
    }

    .btn-feedback {
        font-size: 20px;
        background: none;
        border: 2px solid white;
        border-radius: 5px;
        color: white;
        padding: 5px 15px;
        cursor: pointer;
    }
</style>
